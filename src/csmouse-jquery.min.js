/**
 *
 * @Class		    CSMOUSE / csmouse-class.js, jQuery Plugin
 * @Idea		    Darko B.
 * @Authors		    Darko B. <dbertovi@geowith.us> && Kresimir K. <kreso@geowith.us>
 * @Copyright		Copyright (c) GEO With Us Corp. USA, New York, NY
 * @Version		    1.2 Apr-2014
 * @License		    Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)
 * @ComercialUse	Feel free to study and addapt for personal use, but for commercial or any enterprise use, please contact us @ copyright@geowith.us
 * @URL			    https://geowith.us/csmouse/
 *
 */
!function(j){j.fn.CSMouse=function(e,t){function i(e,t){return Math.min(e,t)}function s(e,t){return Math.max(e,t)}function n(e){a=e,0==j("#"+c.first).length&&u.parent().append('<input id="'+c.first+'" type="hidden" value="" autocomplete="off" />'),j("#"+c.first).val(e)}function l(e){0==j("#"+c.last).length&&u.parent().append('<input id="'+c.last+'" type="hidden" value="" autocomplete="off" />'),j("#"+c.last).val(e)}function o(){u.removeClass(c.color),function(){l(f);for(var e=i(a,f),t=s(a,f),n=e;n<=t;n++)j(u[n]).addClass(c.color)}(),x()}var r={first:"csmouse_first_"+e,last:"csmouse_last_"+e,values:"csmouse_values_"+e,items:"csmouse_items_"+e,color:"csmouse_color",all:"csmouse_all_elem_"+e,none:"csmouse_none_elem_"+e,togg:"csmouse_toggle_elem_"+e,cnt:"csmouse_cnt_elem_"+e,elems:"csmouse_elems_elem_"+e,json:"csmouse_json_elem_"+e,serial:"csmouse_serial_elem_"+e,output:"id",debug:!1},c=j.extend({},r,t),u=j(this),a=j(this).first().index(),f=(j(this).first().index(),null),d=[],h=[],m=[],p=[],g=function(){u.addClass(c.color),x()},v=function(){u.removeClass(c.color),x()},_=function(){u.addClass(c.color);for(var e=0;e<d.length;e++)j(d[e]).removeClass(c.color);x()},y=this.getSelectedJSON=function(){return"id"===c.output?JSON.stringify(m):JSON.stringify(p)},b=function(){return 0<m.length?alert(y()):alert("Nothing is selected from the list"),!1},C=this.getSelectedSerialize=function(){return"id"===c.output?e+"=on&"+m.join("=on&")+"=on":e+"=on&"+p.join("=on&")+"=on"},k=function(){return 0<m.length?alert(C()):alert("Nothing is selected from the list"),!1},x=function(){d=[],h=[],m=[],p=[];for(var e,t=0;t<u.length;t++){var n,o,i,s=j(u[t]);s.hasClass(c.color)&&(d.push(s),n=s.index(),h.push(n),o=s.attr("id"),m.push(o),i=void 0!==s.attr(c.output)?s.attr(c.output):o,p.push(i))}e=h,0==j("#"+c.values).length&&u.parent().append('<input id="'+c.values+'" type="hidden" value="" autocomplete="off" />'),j("#"+c.values).val(e.join()),0<j("#"+c.cnt).length&&j("#"+c.cnt).text(h.length)};return this.initialize=function(){try{return 0<j("#"+c.cnt).length&&j("#"+c.cnt).text(0),0<j("#"+c.elems).length&&j("#"+c.elems).text(u.length),function(){try{j("#"+c.all).unbind("click").bind("click",function(e){g()}),j("#"+c.none).unbind("click").bind("click",function(e){v()}),j("#"+c.togg).unbind("click").bind("click",function(e){_()}),j("#"+c.json).unbind("click").bind("click",function(e){b(),e.preventDefault()}),j("#"+c.serial).unbind("click").bind("click",function(e){k(),e.preventDefault()})}catch(e){this.settings.debug&&console.error("Error:",e)}}(),function(){0==j("#"+c.items).length&&u.parent().append('<input id="'+c.items+'" type="hidden" value="" autocomplete="off" />');var t=[];u.each(function(e){t.push(u[e].id)}),j("#"+c.items).val(t.join())}(),x(),this.unbind("click").bind("click",function(e){if(f=Array.from(u).indexOf(e.target),e.ctrlKey&&e.shiftKey||e.metaKey&&e.shiftKey?function(){for(var e,t=""===a?e=0:(e=i(a,f),s(a,f)),n=!0,o=e;o<t;o++)if(j(u[o]).hasClass(c.color)){n=!1;break}if(n)for(o=e;o<t;o++)j(u[o]).hasClass(c.color)?j(u[o]).removeClass(c.color):j(u[o]).addClass(c.color);else for(o=e;o<t;o++)j(u[o]).removeClass(c.color);l(f),x()}():e.ctrlKey||e.metaKey?(n(f),l(f),j(u[f]).toggleClass(c.color),x()):e.shiftKey?o():(n(f),l(f),u.removeClass(c.color),u.eq(f).addClass(c.color),x()),"INPUT"!==j(this).prop("tagName"))return e.preventDefault(),e.stopPropagation(),!1}),this}catch(e){this.settings.debug&&console.error("Error:",e)}},this.initialize()}}(jQuery);